Implementationg shallow embedding logic and deep embedding logic

see. https://ocvs.cfv.jp/tr-data/PS2008-014.pdf

